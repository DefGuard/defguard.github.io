---
import { getCollection } from "astro:content";
import { TestmonialCard } from "./TestmonialCard/TestmonialCard";
import "swiper/scss/autoplay";

const testmonials = (await getCollection("testmonials")).sort(
  (f1, f2) => f1.data.order - f2.data.order,
);
---

<div class="swiper MySwiper swiper-container">
  <div class="swiper-wrapper">
    {
      testmonials.map(async (f, index) => {
        const { Content } = await f.render();
        return (
          <TestmonialCard
            name={f.data.name}
            about={f.data.about}
            profile={f.data.profile}
            logo={f.data.logo}
          >
            <Content />
          </TestmonialCard>
        );
      })
    }
  </div>
  <div class="swiper-pagination"></div>
</div>

<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.css"
/>
<script is:inline src="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.js"
></script>
<script is:inline>
  new Swiper(".MySwiper", {
    slidesPerView: 2,
    mousewheel: {
      forceToAxis: true,
    },
    autoplay: {
      delay: 2500,
      disableOnInteraction: false,
    },
    pagination: {
      el: ".swiper-pagination",
      clickable: true,
    },
  });
</script>

<style lang="scss" is:global>
  .swiper-container {
    height: 100%;
    max-height: 100vw;
    min-height: 0;
    min-width: 0;
    max-width: 100vw;
    width: 100%;
    overflow: hidden;
  }

  .swiper-slide {
    width: auto;
    flex-shrink: 0;
    display: block;
    height: 100%;
    max-height: 100%;
  }

  .swiper-wrapper {
    max-height: 100%;
    height: 100%t;
    display: flex;
  }
</style>
