---
linked_github_issue: DG11-03
title: Missing rate limiting on login attempts
status: In Progress
severity: Low
issue_link: https://github.com/DefGuard/defguard/issues/1516
---

### Technical Details

The login endpoint (`/login`) lacks proper rate limiting. This allows an attacker to perform an unlimited number of login attempts within a short period of time. The vulnerability can be exploited to conduct a **brute-force or credential stuffing attack**, where an attacker uses a dictionary of common passwords or a list of compromised credentials to try and gain unauthorized access to user accounts. While the password hashing is secure, the lack of rate limiting makes the system vulnerable to automated attacks.

---

### Proof of Concept

1.  Use a tool like **Burp Suite** or **curl** to repeatedly send `POST` requests to the `/login` endpoint.
2.  In each request, iterate through a list of common passwords for a given username.
3.  The server responds with a login failed message, but there is no delay or temporary lockout after numerous failed attempts.
4.  An attacker could automate this process until a correct password is found.

---

### Recommendations

* **Implement rate limiting:** Restrict the number of failed login attempts from a single IP address or username within a specific time frame (e.g., 5 failed attempts per minute).
* **Introduce account lockout:** After a certain number of failed attempts, temporarily lock the user's account to prevent further automated access.
* **Use a CAPTCHA mechanism:** For a certain number of failed login attempts, require the user to complete a CAPTCHA to verify they are a human and not a bot.