---
title: "DG25-20: Disabled OpenID apps still generate code"
severity: Low
cvss_score: 5.3
cvss_string: "/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:N"
issue_link: https://github.com/DefGuard/defguard/issues/1555
status: Completed
---

### Technical details

1.  Enabled OpenID app generates code:

**Request:**\
\
**GET**
`/api/v1/oauth/authorize?allow=true&scope=openid&&client_id=9szvHNlxY6R3jvbX&redirect_uri=https://isec.pl&state=111&nonce=2&response_type=code`
HTTP/2\
**Host:** defguard.dvpnsec.net\
**Cookie:** defguard_session=KENMUulcmfVkD0W8MZjN4Rjw\
\
**Response:**\
\
**HTTP/2** 302 Found\
**Alt-Svc:** h3=\":443\"; ma=2592000\
**Date:** Mon, 11 Aug 2025 08:17:54 GMT\
**Location:** `https://isec.pl/?code=RgB6g99iosVoVnawCHvNDi1l&state=111`\
**Server:** Caddy\
**Content-Length:** 0

1.  Disabling OpenID app:

**Request:**\
\
**POST** /api/v1/oauth/9szvHNlxY6R3jvbX HTTP/2\
**Host:** defguard.dvpnsec.net\
**Cookie:** defguard_session=KENMUulcmfVkD0W8MZjN4Rjw\
**Content-Length:** 17\
**Content-Type:** application/json\
**Sec-Ch-Ua-Mobile:** ?0\
**User-Agent:** Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36
(KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36\
\
{\"enabled\":false}\
\
\
**Response:**\
\
**HTTP/2** 200 OK\
**Alt-Svc:** h3=\":443\"; ma=2592000\
**Content-Type:** application/json\
**Date:** Mon, 11 Aug 2025 08:18:23 GMT\
**Server:** Caddy\
**X-Defguard-Version:** 1.5.0-a29ac10\
**Content-Length:** 2\
\
{}

1.  Confirming, that the application is disabled:

**Request:**\
\
**GET** /api/v1/oauth HTTP/2\
**Host:** defguard.dvpnsec.net\
**Cookie:** defguard_session=KENMUulcmfVkD0W8MZjN4Rjw\
\
\
**Response:**\
\
**HTTP/2** 200 OK\
**Alt-Svc:** h3=\":443\"; ma=2592000\
**Content-Type:** application/json\
**Date:** Mon, 11 Aug 2025 08:18:27 GMT\
**Server:** Caddy\
**X-Defguard-Version:** 1.5.0-a29ac10\
**Content-Length:** 1016\
\[\...\]


```json
{
  "client_id ": "9szvHNlxY6R3jvbX ",
  "client_secret ": "SHyMugRCmiTkLdo1xtV5IwgrY1dKoHpN ",
  "enabled ": false,
  "id ": 8,
  "name ": "openIDApp ",
  "redirect_uri ": [
    "https://isec.pl "
  ],
  "scope ": [
    "openid "
  ]
}
 [ ... ]
```
1.  OpenID app - even though it\'s disabled - still generates the code:

**Request:**\
\
**GET**
`/api/v1/oauth/authorize?allow=true&scope=openid&&client_id=9szvHNlxY6R3jvbX&redirect_uri=https://isec.pl&state=111&nonce=2&response_type=code`
HTTP/2\
**Host:** defguard.dvpnsec.net\
**Cookie:** defguard_session=KENMUulcmfVkD0W8MZjN4Rjw\
\
\
**Response:**\
\
**HTTP/2** 302 Found\
**Alt-Svc:** h3=\":443\"; ma=2592000\
**Date:** Mon, 11 Aug 2025 08:36:11 GMT\
**Location:** `https://isec.pl/?code=zFxh24MQbj8XQ4yDplh1QkoP&state=111`\
**Server:** Caddy\
**Content-Length:** 0

The code, however, does not work on the POST /api/v1/oauth/token HTTP/2
endpoint (when the OpenID app is disabled).
