---
title: "DG25-29: [desktop_client] WireGuard configuration in the Defugard service logs"
severity: Info
cvss_score: 3.3
cvss_string: "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
issue_link: https://github.com/DefGuard/defguard/issues/1545
---

### Technical details

Read permissions of the Defguard service log files are granted to all
users on Linux, MacOS and Windows.Source code responsible for logging
WireGuard configuration is not a part of the Defguard Desktop Client
repository.The source code belongs to its dependency, to the
defguard_wireguard_rs library.

https://github.com/DefGuard/wireguard-rs/blob/main/src/wgapi_windows.rs#L33-L234
```rust
fn configure_interface(&self,config: **&**InterfaceConfiguration,dns: **&** [IpAddr ],search_domains: **&** [&**str**]) - > Result <(), WireguardInterfaceError > 
{ 
debug!("Configuring interface {} with config: {config:?}"*,self.ifname);
[...]
debug!("Interface {} configured with config: {config:?}",self.ifname);
}
```
https://github.com/DefGuard/wireguard-rs/blob/main/src/wgapi_linux.rs#L33-L96
```rust
fn configure_interface(&self,config: **&**InterfaceConfiguration) - > Result <(), WireguardInterfaceError > { 
debug!("Configuring interface {} with config: {config:?} ",self.ifname); 
[ ... ] 
debug!( "Interface {} configured with config: {config:?} ",self.ifname 
);
```
https://github.com/DefGuard/wireguard-rs/blob/main/src/wgapi_userspace.rs#L159-L207
```rust
fn configure_interface(&self,config: &InterfaceConfiguration,) - > Result <(), WireguardInterfaceError > { 
debug!("Configuring interface {} with config: {config:?} "*,self.ifname); 
[ ... ]
debug!("Interface {} configured with config: {config:?} ", self.ifname);
```
https://github.com/DefGuard/wireguard-rs/blob/main/src/wgapi_freebsd.rs#L58-L114

```rust
fn configure_interface(&self, config: **&**InterfaceConfiguration) - > Result <(), WireguardInterfaceError > { 
debug!("Configuring interface {} with config: {config:?} ",self.ifname); 
[ ... ]
debug!("Interface {} configured with config: {config:?} ", self.ifname);
```

#### Proof of Concept

Windows log file permissions:
```sh
C:\\\>icacls
\"C:\\Logs\\defguard-service\\defguard-service.log.2025-08-26\"C:\\Logs\\defguard-service\\defguard-service.log.2025-08-26
BUILTIN\\Administrators:(I)(F)NT
AUTHORITY\\SYSTEM:(I)(F)BUILTIN\\Users:(I)(RX)NT
AUTHORITY\\Authenticated Users:(I)(M)
```
MacOS log file permissions:
```sh
\$ ls -l
/var/log/defguard-service/defguard-service.log.2025-08-23-rw-r\--r\-- 1
root wheel 598 23 sie 19:40
/var/log/defguard-service/defguard-service.log.2025-08-23
```
Linux log file permissions:
```sh
\$ ls -l
/var/log/defguard-service/defguard-service.log.2025-08-23-rw-r\--r\-- 1
root root 31531 Aug 22 22:39
/var/log/defguard-service/defguard-service.log.2025-08-23
```
Simple command allows to read configuration used to set up a WireGuard
interface.

```json
 $ grep -i key /var/log/defguard-service/defguard-service.log.2025-08-23 | head -1
{
  "timestamp": "2025-08-23T02:37:08.102088Z",
  "level": "DEBUG",
  "fields": {
    "message": "Configuring interface wg1337 with config: InterfaceConfiguration { 
      name: \"wg1337\", 
      addresses: [IpAddrMask { ip: 10.22.33.20, cidr: 24 }], 
      port: 1337, 
      peers: [
        Peer { 
          public_key: c2ae6e16af449e74509080c9af723f6d84bf12106fc1ce27a6d21ec278737615,
          preshared_key: Some(0000000000000000000000000000000000000000000000000000000000000000),
          protocol_version: Some(1),
          endpoint: Some(167.172.191.17:51820),
          last_handshake: Some(SystemTime { tv_sec: 0, tv_nsec: 0 }),
          tx_bytes: 0,
          rx_bytes: 0,
          persistent_keepalive_interval: Some(300),
          allowed_ips: [IpAddrMask { ip: 10.22.33.0, cidr: 24 }]
        }
      ],
      mtu: None
    }",
    "log.target": "defguard_wireguard_rs::wgapi_linux",
    "log.module_path": "defguard_wireguard_rs::wgapi_linux",
    "log.file": "/home/user/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/defguard_wireguard_rs-0.7.4/src/wgapi_linux.rs",
    "log.line": 37
  },
  "target": "defguard_wireguard_rs::wgapi_linux",
  "span": {
    "interface_name": "wg1337",
    "name": "create_interface"
  },
  "spans": [
    { "name": "defguard_service" },
    { "interface_name": "wg1337", "name": "create_interface" }
  ]
}
```