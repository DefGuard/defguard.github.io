---
title: "DG25-25: Access token is not being revoked when OpenID app becomes disabled"
severity: Low
cvss_score: 4.3
cvss_string: "/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
issue_link: https://github.com/DefGuard/defguard/issues/1554
status: Completed
---

### Technical details

1.  User authorizes to the OpenID app:

**Request:**\
\
**POST** /api/v1/oauth/token HTTP/2\
**Host:** defguard.dvpnsec.net\
**Content-Length:** 165\
**Content-Type:** application/x-www-form-urlencoded\
\
grant_type=authorization_code&redirect_uri=`https://isec.pl&code=rheXiUUlXW34MwoOS7PWxlLV&client_id=9szvHNlxY6R3jvbX&client_secret=SHyMugRCmiTkLdo1xtV5IwgrY1dKoHpN&`\
\
**Response:**\
\
**HTTP/2** 200 OK\
**Alt-Svc:** h3=\":443\"; ma=2592000\
**Content-Type:** application/json\
**Date:** Tue, 12 Aug 2025 10:23:05 GMT\
**Server:** Caddy\
**X-Defguard-Version:** 1.5.0-a29ac10\
**Content-Length:** 124\


```json
{ 
"access_token ": "Dyg8SocRFYixyEI2qMZRBMpi ", 
"id_token ":null, 
"refresh_token ": "NL12wUK2mzs5mz0u1V3WLPmE ", 
"token_type ": "bearer "
}
```

1.  Administrator disables the app:

**Request:**\
\
**POST** /api/v1/oauth/9szvHNlxY6R3jvbX HTTP/2\
**Host:** defguard.dvpnsec.net\
**Cookie:** defguard_session=KENMUulcmfVkD0W8MZjN4Rjw\
**Content-Length:** 17\
**Content-Type:** application/json\
**Sec-Ch-Ua-Mobile:** ?0\
**User-Agent:** Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36
(KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36\
\
{\"enabled\":false}\
\
\
**Response:**\
\
**HTTP/2** 200 OK\
**Alt-Svc:** h3=\":443\"; ma=2592000\
**Content-Type:** application/json\
**Date:** Tue, 12 Aug 2025 10:23:56 GMT\
**Server:** Caddy\
**X-Defguard-Version:** 1.5.0-a29ac10\
**Content-Length:** 2\
\
{}

1.  access_token is not being revoked - user can still use it.

**Request:**\
\
**GET** /api/v1/oauth/userinfo HTTP/2\
**Host:** defguard.dvpnsec.net\
**Authorization:** Bearer Dyg8SocRFYixyEI2qMZRBMpi\
\
\
**Response:**\
\
**HTTP/2** 200 OK\
**Alt-Svc:** h3=\":443\"; ma=2592000\
**Content-Type:** application/json\
**Date:** Tue, 12 Aug 2025 10:25:54 GMT\
**Server:** Caddy\
**X-Defguard-Version:** 1.5.0-a29ac10\
**Content-Length:** 156\


```json
{ 
"email ": "phtest2+fdsfsdfsdfdsfds@isec.pl ", 
"family_name ": "A ", 
"given_name ": "A ",
"name ": "AA ", 
"phone_number ": "123123 ",
"preferred_username ": "user ", 
"sub ": "user "
}
```