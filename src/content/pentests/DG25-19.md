---
title: "DG25-19: Clickjacking vulnerability"
severity: Medium
cvss_score: 5.3
cvss_string: "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N"
issue_link: https://github.com/DefGuard/defguard/issues/1513
status: Completed
---

### Technical details

Multiple instances of this issue have been identified, but the most
serious and real threat - given the application\'s specifics - is the
login panel of the application:

-   `https://defguard.dvpnsec.net/auth/login`

The attacker can lure (through an appropriate pretext) a potential
victim to visit what appears to be the login page of the web
application:

![](/images/pentest/DG25/img7.png)


The page above has been specially prepared to display the actual login
interface (loaded in an iframe) with additional elements overlaid on
top.

This is a specific case of clickjacking vulnerability known as UI
redressing - overlaying additional interface elements on the original
interface; specific because in a standard clickjacking scenario, the
iframe containing the original site would have opacity: 0, and a button
would be placed over another button in the original UI that performs an
action sensitive to the user (e.g., sending funds to another user).

In the background, a request is made to the server (loading the original
site in the iframe):

**Request:**\
\
**GET** /auth/login **HTTP**/2\
**Host:** defguard.dvpnsec.net\
**Upgrade**-**Insecure**-**Requests:** 1\
**User**-**Agent:** **Mozilla**/5.0 (**Windows** **NT** 10.0; **Win64**;
x64) **AppleWebKit**/537.36 (**KHTML**, like **Gecko**)
**Chrome**/138.0.0.0 **Safari**/537.36\
\
\
**Response:**\
\
**HTTP**/2 200 **OK**\
**Alt**-**Svc:** h3=*\":443\"*; ma=2592000\
**Content**-**Type:** text/html\
**Date:** **Fri**, 08 **Aug** 2025 14**:**02**:**29 **GMT**\
**Server:** **Caddy**\
**Content**-**Length:** 2046\


```html
<!doctype html> 
 <html lang="en" data-theme="light"> 
 <head> 
 <meta charset="UTF-8"> 
 <meta name="viewport " content="width=device-width,initial-scale=1.0"> 
 <meta name="apple-mobile-web-app-capable" content="yes"> 
 <meta name="mobile-web-app-capable" content= "yes "> 
 <meta name="theme-color" content="#ffffff"> 
 <link rel="manifest" href="/assets/manifest-D4HWI1P1.webmanifest"> 
 <! --  Icons   -- > 
 <link rel=  "icon "    type  =  "image/ico" href=  "/assets/favicon-CcP5hR9D.ico"> 
 <link rel=  " [TRUNCATED ]
```


As it can be seen in the server\'s response - it does not contain the
X-Frame-Options and Content-Security-Policy headers, which does not
restrict framing the site and enables possibility of a clickjacking
attack.

When the user enters their data in the login form and clicks the
apparent login button, the attacker receives a GET request that reveals
login credentials:

![](/images/pentest/DG25/img8.png){width="4.374305555555556in" height="1.8625in"}
