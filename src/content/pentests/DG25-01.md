---
title: "DG25-1: Login enumeration"
cvss_score: 5.3
severity: Low
cvss_string: "/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N"
issue_link: https://github.com/DefGuard/defguard/issues/1557
---

### Technical details

-   User testtest exists:

**Request:**\
\
**POST** /api/v1/auth HTTP/2\
**Host:** defguard.dvpnsec.net\
**Content-Length:** 37\
**Content-Type:** application/json\
**User-Agent:** Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36
(KHTML, like Gecko) Chrome/138.0.0.0\
\
{\"username\":\"testtest\",\"password\":\"\"}\
\
\
**Response:**\
\
**HTTP/2** 401 Unauthorized\
**Alt-Svc:** h3=\":443\"; ma=2592000\
**Content-Type:** application/json\
**Date:** Mon, 04 Aug 2025 09:10:42 GMT\
**Server:** Caddy\
**X-Defguard-Version:** 1.5.0-a29ac10\
**Content-Length:** 26\
\
{\"msg\":\"invalid password\"}

-   User test404 does not exist:

**Request:**\
\
**POST** /api/v1/auth HTTP/2\
**Host:** defguard.dvpnsec.net\
**Content-Length:** 36\
**Content-Type:** application/json\
**User-Agent:** Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36
(KHTML, like Gecko) Chrome/138.0.0.0\
\
{\"username\":\"test404\",\"password\":\"\"}\
\
\
**Response:**\
\
**HTTP/2** 401 Unauthorized\
**Alt-Svc:** h3=\":443\"; ma=2592000\
**Content-Type:** application/json\
**Date:** Mon, 04 Aug 2025 09:10:55 GMT\
**Server:** Caddy\
**X-Defguard-Version:** 1.5.0-a29ac10\
**Content-Length:** 93\
\
{\"msg\":\"Missing required LDAP settings: LDAP URL is required for LDAP
configuration to work\"}


### Recommendations

To prevent enumeration vulnerabilities, following mitigation steps
should be taken:

-   Generic error messages: Make sure the application displays the same
    error message for valid and invalid usernames for log-in attempt in
    to prevent attackers from distinguishing them.

-   Implement account lockout rules: Configure account lockout rules
    that do not reveal account status (locked or unlocked) to users or
    attackers. Account lockout for specified username should be based on
    a certain number of failed attempts, not on whether the account
    exists or not.

-   Introduce a limit on the rate of requests sent to reduce the number
    of checks for brute-force attacks.

-   Use universal unique identifiers (UUIDs) or random strings as
    resource identifiers instead of incremental numbering.
