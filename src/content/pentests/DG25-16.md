---
title: "DG25-16: HTML Injection - password reset"
severity: Low
cvss_score: 3.5
cvss_string: "/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:N/A:N"
issue_link: https://github.com/DefGuard/defguard/issues/1545
status: Completed
---


### Technical details

1.  Data from User-Agent header is not being sanitized. Malicious actor
    may send a reset link to any DefGuard user - with HTML content which
    will be rendered in the user\'s mailboxes.

**Request:**\
\
**POST** /api/v1/password-reset/request HTTP/2\
**Host:** defguard-enroll.dvpnsec.net\
**User-Agent:** browser \<h1\>\<a href=\"//isec.pl\"\>CLICK
HERE\</a\>\</h1\>\
**Content-Type:** application/json\
**Content-Length:** 40\
\
{\"email\":\"phtest2+fdsfdszxczxc@isec.pl\"}\
\
\
**Response:**\
\
**HTTP/2** 200 OK\
**Alt-Svc:** h3=\":443\"; ma=2592000\
**Date:** Fri, 08 Aug 2025 09:56:26 GMT\
**Server:** Caddy\
**Content-Length:** 0

1.  \<h1\>\<a href=\"//isec.pl\"\>CLICK HERE\</a\>\</h1\> is being
    rendered.

![](/images/pentest/DG25/img5.png)
