---
title: "DG25-15: TOTP brute-forcing due to lack of rate limiting"
cvss_score: 6.5
severity: Medium
cvss_string: "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N"
issue_link: https://github.com/DefGuard/defguard/issues/1523
status: Completed
---

### Technical details

During the penetration testing phase, it was confirmed that no
rate-limiting mechanism was implemented on the tested endpoint. As a
result, it is possible to perform a brute-force attack on the TOTP code
during the login process.

**Request:**\
\
**POST** /api/v1/auth/totp/verify **HTTP**/2\
**Host:** defguard.dvpnsec.net\
**Cookie:** defguard_session=**EvZY1GdAv12whFOLBrNC7jYW**\
**Content**-**Length:** 17\
**Content**-**Type:** application/json\
**User**-**Agent:** **Mozilla**/5.0 (**Windows** **NT** 10.0; **Win64**;
x64) **AppleWebKit**/537.36 (**KHTML**, like **Gecko**)
**Chrome**/138.0.0.0 **Safari**/537.36\
**Origin:** https**://**defguard.dvpnsec.net\
**Referer:** https**://**defguard.dvpnsec.net/auth/mfa/totp\
\
{*\"code\"***:***\"111111\"*}\
\
\
**Response:**\
\
**HTTP**/2 401 **Unauthorized**\
**Alt**-**Svc:** h3=*\":443\"*; ma=2592000\
**Content**-**Type:** application/json\
**Date:** **Tue**, 12 **Aug** 2025 09**:**42**:**24 **GMT**\
**Server:** **Caddy**\
**X**-**Defguard**-**Version:** 1.5.0-a29ac10\
**Content**-**Length:** 27\
\
{*\"msg\"***:***\"Invalid TOTP code\"*}

Neither X-Rate-Limit-Limit nor X-Rate-Limit-Remaining headers were
present in the responses.

In one test, over 10,000 requests were sent within 30 seconds without
triggering any throttling or rejection. With optimized attack parameters
--- including careful selection of concurrent request count, appropriate
OTP code range, and running the brute-force attempt continuously with
timing aligned to OTP generation intervals --- the correct TOTP value
was successfully identified, resulting in a verified session:

![](/images/pentest/DG25/img4.png)
