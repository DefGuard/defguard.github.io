---
title: "DG25-14: Plain-text passwords stored in logs"
cvss_score: 6.0
severity: Low
cvss_string: "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:C/C:H/I:N/A:N"
issue_link: https://github.com/DefGuard/defguard/issues/1558
status: Completed
---

### Technical details

During security assessment, we were able to identify two cases in which
plain-text user passwords were stored in Defguard\'s logs.

The first occurrence regards initial password creation in an enrollment
process, the other one relates to password resetting procedure:

```sh
root@defguard:~# docker logs -f 8f4c285f04c0 | grep "Asdf"

2025-08-06T13:48:40.571864Z DEBUG run_grpc_bidi_stream: defguard_core::grpc:
Received the following message from proxy:
CoreRequest {
    id: 32,
    device_info: Some(DeviceInfo {
        ip_address: "167.172.191.17",
        user_agent: Some("Mozilla/5.0 (Windows NT 10.0; Win64; x64)
                          AppleWebKit/537.36 (KHTML, like Gecko)
                          Chrome/138.0.0.0 Safari/537.36")
    }),
    payload: Some(ActivateUser(
        ActivateUserRequest {
            phone_number: None,
            password: "Asdf123!",
            token: Some("b9I61jO3OIlMGYJXhd7mbdsOOpwcuz9L")
        }
    ))
}

2025-08-06T13:48:40.571901Z DEBUG run_grpc_bidi_stream:activate_user: defguard_core::grpc::enrollment:
Activating user account:
ActivateUserRequest {
    phone_number: None,
    password: "Asdf123!",
    token: Some("b9I61jO3OIlMGYJXhd7mbdsOOpwcuz9L")
}

2025-08-06T14:00:37.437221Z DEBUG run_grpc_bidi_stream: defguard_core::grpc:
Received the following message from proxy:
CoreRequest {
    id: 48,
    device_info: Some(DeviceInfo {
        ip_address: "167.172.191.17",
        user_agent: Some("Mozilla/5.0 (Windows NT 10.0; Win64; x64)
                          AppleWebKit/537.36 (KHTML, like Gecko)
                          Chrome/138.0.0.0 Safari/537.36")
    }),
    payload: Some(PasswordReset(
        PasswordResetRequest {
            password: "Asdf123!",
            token: Some("d1w53URFvtfChGfoW8WOzZTXN2fCtfLg")
        }
    ))
}

2025-08-06T14:00:37.437246Z DEBUG run_grpc_bidi_stream:reset_password: defguard_core::grpc::password_reset:
Starting password reset:
PasswordResetRequest {
    password: "Asdf123!",
    token: Some("d1w53URFvtfChGfoW8WOzZTXN2fCtfLg")
}
```

As it can be seen in the code-block above, in both situations -
plain-text passwords (Asdf123!) were saved in logs.

**Disclaimer:** these logs are readable only by users who have SSH
access to the VPS; remote exploitation solely via the web interface is
not possible without such access. Because of that prerequisite - our
severity rating has been downgraded to Low in regard to
CVSS3.1-calculated Medium severity.
