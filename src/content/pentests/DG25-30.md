---
title: "DG25-30: [desktop_client] Summary"
severity: Info
issue_link: https://github.com/DefGuard/defguard/issues/1556
---

### Summary

The analysis revealed three weaknesses, verified some theses and
rejected others that do not apply to the application's use cases.The
most serious vulnerability allows a user (or process) with low
privileges to manage WireGuard interfaces.

#### Dependencies

Node audit reports three public-known vulnerabilities detected in
dependencies of the repository.The possibility of exploiting these
vulnerabilities in the application has not been confirmed.Security best
practices require monitoring and updating project dependencies.

**Moderate**  
*esbuild enables any website to send any requests to the development server and read the response.*

- **Package:** esbuild  
- **Vulnerable versions:** <= 0.24.2  
- **Patched versions:** >= 0.25.0  
- **Paths:** > vite > esbuild  
- **More info:** https://github.com/advisories/GHSA-67mh-4wv8-2f99

**Low**  
*brace-expansion Regular Expression Denial of Service vulnerability*

- **Package:** brace-expansion  
- **Vulnerable versions:** >= 1.0.0 <= 1.1.11  
- **Patched versions:** >= 1.1.12  
- **Paths:** > eslint > minimatch > brace-expansion  
- **More info:** https://github.com/advisories/GHSA-v6h2-p8h4-qcjw

**Low**  
*brace-expansion Regular Expression Denial of Service vulnerability*

- **Package:** brace-expansion  
- **Vulnerable versions:** >= 2.0.0 <= 2.0.1  
- **Patched versions:** >= 2.0.2  
- **Paths:** > @svgr/cli > glob > minimatch > brace-expansion  
- **More info:** https://github.com/advisories/GHSA-v6h2-p8h4-qcjw

#### OS's native tools and libraries

The application depends on the tools and libraries of the operating
system.

First of all, the official WireGuard client is required for all
supporting operating systems.

-   https://www.wireguard.com/install/.

Application for the Linux requires additional the resolvconf and the ip
tools.Application for the MacOS requires additional the networksetup
tool.

Finally, the appropriate web engine is required for each operating
system.

In some cases, the application may not work due to unmet
dependencies.![](/images/pentest/DG25/img11.png){width="43.075483377077866in"
height="2.2417125984251967in"}

All of the mentioned components do not belong to the application
project, so the user is responsible for installing them and maintaining
security updates.

There is another potential risk associated with the use of external
tools.If a malicious user finds a way to modify the PATH environment
variable of the Defguard service, then privilege escalation becomes very
easy.

#### Web renderer

The user interface is built using web technologies, which introduces the
risk of security vulnerabilities known to the frontend.Analysis showed
that developers follow good practices and the application does not load
remote resources at runtime, so the risk is limited.

#### Local port of the gRPC service

Service listening on a local port and expecting HTTP requests can be
targeted from a web browser.In the worst scenario, visiting a dangerous
site may result in the successful exploitation.

This attack vector does not apply to the gRPC service for two reasons:

1.  The gRPC uses HTTP2 features that are beyond the control of the
    JavaScript.

2.  The gRPC service does not return a valid CORS response, so the web
    browser abandons further requests.

However, in the case of the Defgurad Desktop Client, the gRPC service
listening on local port (127.0.0.1:54127) introduces a LPE/EoP
vulnerability.

#### Recommendations

The main recommendation is to fix the reported vulnerabilities.

Mnimizing dependencies will reduce the risk associated with their
confirmed and potential vulnerabilities.Eliminating dependence on system
components could improve application reliability and also eliminate the
potential risk associated with modifying the PATH environment variable.

The application uses default TLS/SSL verification when connecting to the
Defguard server.Introducing support for custom CA and certificate
pinning would raise the security level.
