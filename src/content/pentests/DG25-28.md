---
title: "DG25-28: [desktop_client] Wide file permissions"
severity: Low
cvss_score: 3.3
cvss_string: "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N"
issue_link: https://github.com/DefGuard/client/issues/563
status: Completed
---

### Technical details

Files on Linux and MacOS have permissions defined for three subsets of
system users:

-   \"user\" - the single user who owns the file

-   \"group\" - the group of users the owner is associated with

-   \"others\" - everyone else

Permissions define who and what can read, write to, and execute.

The application creates files for which read permissions are granted to
the group and other users, while the database contains confidential
data.For directories, execute permissions are also granted to the group
and other users.

Linux:

\$ find \~/.local/share/net.defguard -ls391834 4 drwxr-xr-x 3 user user
4096 Aug 22 00:59 /home/user/.local/share/net.defguard392815 64
-rw-r\--r\-- 1 user user 61440 Aug 22 00:59
/home/user/.local/share/net.defguard/defguard.db445399 4 drwxr-xr-x 2
user user 4096 Aug 20 09:14
/home/user/.local/share/net.defguard/localstorage445400 12 -rw-r\--r\--
1 user user 12288 Aug 21 10:02
/home/user/.local/share/net.defguard/localstorage/tauri_localhost_0.localstorage445402
32 -rw-r\--r\-- 1 user user 32768 Aug 21 10:02
/home/user/.local/share/net.defguard/localstorage/tauri_localhost_0.localstorage-shm445401
0 -rw-r\--r\-- 1 user user 0 Aug 21 10:02
/home/user/.local/share/net.defguard/localstorage/tauri_localhost_0.localstorage-wal395561
4 -rw-r\--r\-- 1 user user 106 Aug 20 09:14
/home/user/.local/share/net.defguard/config.json

\$ sqlite3 -column -header \~/.local/share/net.defguard/defguard.db
\"select id,prvkey,server_pubkey,endpoint from tunnel;\"id prvkey
server_pubkey endpoint\--
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--
\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\-\--1
kxiyB6eBem2ZHnTWMApvck5jkKMtGG4eDk88NwM09WM=
wq5uFq9EnnRQkIDJr3I/bYS/EhBvwc4nptIewnhzdhU= 167.172.191.17:51820

MacOS:

\$ ls -l /System/Volumes/Data/Users/user/Library/Application\\
Support/net.defguardtotal 264-rw-r\--r\-- 1 user staff 106 10 lip 16:36
config.json-rw-r\--r\-- 1 user staff 98304 14 lip 19:59 defguard.db
