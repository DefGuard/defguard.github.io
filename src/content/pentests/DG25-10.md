---
severity: Low
title: "DG25-10: Lack of server-side data validation during the enrollment process"
cvss_score: 4.3
cvss_string: "/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N"
issue_link: https://github.com/DefGuard/defguard/issues/1553
status: Completed
---

### Technical details

The phone number is being validated only at the GUI-level. User - during
the enrollment process may insert any non-digits characters into
phone-number field:

**Request:**\
\
**POST** /api/v1/enrollment/activate_user HTTP/2\
**Host:** defguard-enroll.dvpnsec.net\
\[\...\]\
\
{\"password\":\"Pentest2025!!!\",\"phone_number\":\"{{ 4\*4 }}\"}\
\
\
**Response:**\
\
**HTTP/2** 200 OK\
**Alt-Svc:** h3=\":443\"; ma=2592000\
**Date:** Wed, 06 Aug 2025 09:38:03 GMT\
**Server:** Caddy\
**Set-Cookie:** defguard_proxy=; Max-Age=0; Expires=Tue, 06 Aug 2024
09:38:03 GMT\
**Content-Length:** 0

User was enrolled with invalid phone number:

**Request:**\
\
**GET** /api/v1/user HTTP/2\
**Host:** defguard.dvpnsec.net\
\[\...\]\
\
\
**Response:**\
\
**HTTP/2** 200 OK\
**Alt-Svc:** h3=\":443\"; ma=2592000\
**Content-Type:** application/json\
**Date:** Wed, 06 Aug 2025 09:38:34 GMT\
**Server:** Caddy\
**X-Defguard-Version:** 1.5.0-a29ac10\
**Content-Length:** 2899\
\[\...\]\
\
\"id\":40,\"is_active\":true,\"is_admin\":false,\"last_name\":\"XXX\",\"ldap_pass_requires_change\":false,\"mfa_enabled\":false,\"mfa_method\":\"None\",\"phone\":\"{{
4\*4 }}\",\"totp_enabled\":false,\"username\":\"fdfdfdfd\" \[\...\]
