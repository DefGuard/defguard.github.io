---
import Navigation from "../components/base/Navigation.astro";
import HomeSection from "../components/home/HomeSection.astro";
import ProductLayout from "../layouts/ProductLayout.astro";
import Testimonials from "./_home/components/client-side/Testimonials/Testimonials";
import type { TestimonialData } from "./_home/components/client-side/Testimonials/type";
import { testimonialSchema } from "./_home/components/client-side/Testimonials/type";
import FlexibleIdentitySection from "./_home/components/FlexibleIdentity/FlexibleIdentitySection.astro";
import HomeHeader from "./_home/components/HomeHeader.astro";
import Roadmap from "./_home/components/Roadmap/Roadmap.astro";
import FlexibleSection from "../components/FlexibleSection.astro";
import ServerSidebar from "../components/server/ServerSidebar.astro";
import signinwith from "/public/images/data/signinwith.png";
import enrollment from "/public/images/data/enrollment-screen.png";
import api from "/public/images/data/api.png";
import Image from "astro/components/Image.astro";
import YouTubeVideo from "../components/video/YouTubeVideo.astro";
import CTASection from "../components/CTASection.astro";
import ImageCarousel from "../components/image/ImageCarousel.astro";
import ImageURL from "../components/image/ImageURL.astro"

const testimonialsImportData = await Astro.glob("../data/home/testimonials/**/*.md");

const testimonialsData: Array<TestimonialData> = testimonialsImportData.map((val) => {
  const toValidate = { ...val.frontmatter, markdownRaw: val.rawContent() };
  const res = testimonialSchema.parse(toValidate);
  return res;
});

const title = "Enterprise WireGuard® VPN with Native MFA & Zero-Trust Architecture";
const featuredImage =
  "github.com/DefGuard/defguard.github.io/raw/main/public/images/product/core/hero-image.png";
const imageWidth = "1920";
const imageHeight = "1080";
const url = "https://defguard.net/server";
const tags = [
  "defguard",
  "server",
  "WireGuard®",
  "vpn",
  "mfa",
  "2fa",
  "WireGuard®",
  "ldap",
  "openldap",
  "postgresql",
  "postgres",
  "openid",
  "totp",
  "webauthn",
  "opensense",
  "freebsd",
  "rust",
  "secure",
  "docker",
  "kubernetes",
  "k8s",
];

const sections = [
  { id: "multiple-instances-and-vpn", title: "Multiple instances and VPN" },
  { id: "true-2fa-multi-factor", title: "True 2FA/Multi-Factor" },
  { id: "instant-vpn-configuration-updates", title: "Instant VPN configuration updates" },
  { id: "detailed-connection-overview", title: "Detailed connection overview" },
  { id: "multiplatform-multi-architecture", title: "Multiplatform and Multi architecture" },
  { id: "any-wireguard", title: "Universal WireGuard® Support" },
];
---

<ProductLayout
  title={title}
  featuredImage={featuredImage}
  imageWidth={imageWidth}
  imageHeight={imageHeight}
  url={url}
  tags={tags}
>
  <Navigation activeSlug="/client/" />

  <main id="client-page" class="with-sidebar-nav">
    <HomeHeader
      trustedBy={false}
      title="The Best WireGuard® desktop client"
      description="Beautiful open-source, cross-platform client, with real WireGuard® 2FA/Multi-Factor Authentication. "
      buttons={[
        { name: "Download Client", link: "/download/" }//,
        //{ name: "Book a Demo", link: "/book-a-demo/" }
      ]}
    />
    
    <!-- New content wrapper that appears after header -->
    <div class="page-content-wrapper">
      <aside class="sidebar-container">
        <ServerSidebar sections={sections} title="Main features"/>
      </aside>

      <div class="main-content">
        <FlexibleSection
          title="Multiple instances and VPN locations in one client"
          id="multiple-instances-and-vpn"
          variant="gray"
          theme="light"
        >
          <div slot="left">
            <p>
              View all user activity and statistics at a glance on a unified dashboard, or dive into detailed views for each location.
            </p>
            <div class="learn-more">
              <a
                href="https://docs.defguard.net/admin-and-features/wireguard/network-overview"
                class="learn-more-link"
              >
                Learn about Network Overview
          </a>
        </div>
          </div>

          <div slot="right">
            <ImageCarousel
              src="/images/features/Manage multiple VPN1.png,/images/features/Manage multiple VPN2.png" alt="Manage multiple VPN"
              interval={3}
              autoplay={true}
            />
          </div>
        </FlexibleSection>

        <FlexibleSection
          title="True 2FA/Multi-Factor authentication on WireGuard®"
          id="true-2fa-multi-factor"
          variant="white"
          theme="light"
        >
          <div slot="left">
            <ImageURL src="/images/features/Multiple instances - desktop.png" alt="Multiple instances" />
          </div>

          <div slot="right">
            <p>
              Defguard is uniquely designed for MSPs, cloud providers, and data centers. It allows deployment of multiple isolated Defguard instances (for different clients, sites, etc.) while maintaining unified access through a single desktop app.
            </p>
            <p>
              <em>Mobile support coming in version 1.5!</em>
            </p>
          </div>
        </FlexibleSection>

        <FlexibleSection
          title="Instant VPN configuration updates and flexible client management"
          id="instant-vpn-configuration-updates"
          variant="gray"
          theme="light"
        >
          <div slot="left">
            <ul>
              <li>Each connection can require 2FA/MFA—using either the built-in Defguard IdP or external SSO providers like Google, Microsoft, Okta, and others—enabling true Zero Trust security.
              </li>
              <li>Adhering to the highest security standards — VPN peers are configured only after successful 2FA/MFA, and session-based, randomly generated WireGuard® pre-shared keys are used to maximize security</li>
            </ul>
          </div>

          <div slot="right">
            <ImageCarousel
              src="/images/features/True 2FA.png,/images/features/True 2FA2.png" alt="True 2FA/Multi-Factor authentication on WireGuard®"
              interval={3}
              autoplay={true}
            />
          </div>
        </FlexibleSection>

        <FlexibleSection
          title="Detailed connection overview"
          id="detailed-connection-overview"
          variant="white"
          theme="light"
        >
          <div slot="left">
            <ImageURL src="/images/features/Sso active dir.png" alt="Integration with SSO providers, Active Directory, and LDAP" />
          </div>

          <div slot="right">
            <p>
              Defguard supports user and group synchronization with providers like Google, Microsoft, Okta, and JumpCloud, making onboarding and offboarding easy. It also uniquely enables two-way sync with Active Directory and LDAP.
            </p>
          </div>
        </FlexibleSection>

        <FlexibleSection
          title="Multiplatform and Multi architecture"
          id="multiplatform-multi-architecture"
          variant="gray"
          theme="light"
        >
          <div slot="left">
            <p>
              Defguard, in addition to access rules for VPN based on selected users and groups, is the only solution that also offers low-level ACLs by managing the firewall (NFTables on Linux and Packet Filter on FreeBSD/OPNSense).
            </p>

          </div>

          <div slot="right">
            <YouTubeVideo
              videoId="F61_5mR2UpM"
              title="Firewall Rule Management"
              showControls={true}
              showInfo={true}
              allowFullscreen={true}
              rel={false}
            />
          </div>
        </FlexibleSection>

        <FlexibleSection
          title="Any WireGuard® server is supported"
          id="any-wireguard"
          variant="white"
          theme="light"
        >
          <div slot="left">
            <ImageURL src="/images/features/Instant VPN.png" alt="Any WireGuard® server is supported" />
          </div>

          <div slot="right">
            <p>
              Defguard enables real-time synchronization and configuration of client applications used by users. Any changes in VPN configuration or access management are immediately reflected on the user side. Additionally, it allows managing client behavior (e.g., enabling full traffic routing through the VPN or blocking certain features of the client).
            </p>
          </div>
        </FlexibleSection>


        <CTASection
          title="Ready to Implement Enterprise-Grade WireGuard® VPN?"
          description="See how Defguard fits into your zero-trust architecture and existing infrastructure."
          buttonText="Book a Demo"
          buttonLink="/book-a-demo?utm_source=server"
          id="cta-documentation"
          variant="white"
        />

        <!-- <Roadmap variant="white" /> -->
      </div>
    </div>
  </main>
</ProductLayout>

<style lang="scss" is:global>
  img {
    border: 1px solid var(--surface-frame-bg);
    border-radius: 8px;
  }
  main#client-page {
    --page-spacing-factor: 0.5;
    
    @include break-up(lg) {
      --page-spacing-factor: 1;
    }

    .page-content-wrapper {
      display: block;
      width: 100%;
      position: relative;
      
      @include break-up(lg) {
        display: flex;
        flex-direction: row;
        gap: 2rem;
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 2rem;
        align-items: flex-start;
      }
    }

    .sidebar-container {
      display: none;
      
      @include break-up(lg) {
        display: block;
        position: sticky;
        top: calc(var(--nav-height, 75px) + 2rem);
        height: fit-content;
        z-index: 10;
        max-height: calc(100vh - var(--nav-height, 75px) - 4rem);
        overflow-y: auto;
        align-self: start;
        /* Remove any inherited transform or will-change */
        transform: none;
        will-change: auto;
      }
    }

    .main-content {
      flex: 1;
      
      .flexible-section{
        scroll-margin-top: 75px;
        padding: 1.5rem 0;
        margin-bottom: 90px;
        //border: 1px solid var(--border-separator);
        background-color: var(--surface-nav-bg);
        border-radius: 10px;
        box-shadow: var(--box-shadow);
      }

      .flexible-content {
        .section-title {
          @include typography(section);
          padding-bottom: 1rem;
          margin-bottom: 2rem;
        }

        h3 {
          @include typography(h3);
          margin-top: 0;
          margin-bottom: 1rem;
        }

        p {
          @include typography(paragraph);
          margin-bottom: 1.5rem;
        }

        .learn-more {
          margin-bottom: 1.5rem;
        }

        .learn-more-link {
          @include typography(paragraph);
          display: inline-block;
          padding: 0.75rem 1.5rem;
          background-color: var(--primary-button-bg, #0c8ce0);
          color: var(--primary-button-text, white);
          border-radius: 50px;
          font-weight: 300;
          font-size: calc(1rem * var(--font-scale-factor));
          text-decoration: none;
          transition: background-color 0.2s ease-in-out;


          &:hover {
            background-color: var(--primary-button-hover, #0a7bc5);
          }
        }

        ul {
          margin: 0 0 1.5rem 0;
          padding-left: 20px;

          li {
            @include typography(paragraph);
            margin-bottom: 0.5rem;
          }
        }

        em {
          font-size: 0.9em;
          opacity: 0.8;
        }

        .column {
          @media (max-width: 768px) {
            &.right-column {
              margin-top: 1rem;
            }
          }
        }
      }
    }

    #testimonials {
      padding-top: page-spacing(100px);
      padding-bottom: page-spacing(100px);
    }

    .scroll-section {
      padding-top: page-spacing(200px);
      padding-bottom: page-spacing(200px);
    }
  }
</style> 